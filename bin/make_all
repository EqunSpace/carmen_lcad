make_module()
{
	cd $CARMEN_HOME/src/$1
	make
}

make_list_of_modules()
{
	RESULT=0
	for mod in $1
	do
		if [ -d $CARMEN_HOME/src/$mod ]
		then
			make_module $mod
			RESULT=$?
		fi
		if [ ! $RESULT -eq 0 ] && [ "$2" = "EXIT_ON_ERROR" ]
		then
			exit 1
		fi
	done
	return $RESULT
}


$CARMEN_HOME/bin/make_clean_all

MODULES="web_cam tracker lane_detector path_planner . camera velodyne_camera_calibration 
	 camera_boxes_to_world ../sharedlib/libclustering web_cam laser-ldmrs tracker 
	 lane_detector dynamic_object_detector ."

ADDITIONAL_MODULES="graphslam"

make_list_of_modules "$MODULES"

if [ $? -eq 0 ]
then
	make_list_of_modules "$ADDITIONAL_MODULES" EXIT_ON_ERROR
fi

